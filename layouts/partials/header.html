{{ "<!-- navigation -->" | safeHTML }}
<header class="navigation">
  <div class="container wrap">
    <div class="logo">
      <a href='{{ if eq .Site.Language.Lang "en" }}{{ site.BaseURL }}{{ else }}{{ site.BaseURL }}{{ .Site.Language.Lang }}{{end}}' title="{{ site.Title }}">
        <img loading="eager" decoding="async" fetchpriority="high" width="{{ site.Params.logo_width}}" class="img-fluid" src="{{ site.Params.logo | absURL }}" alt="{{ site.Title }}">
      </a>
    </div>

    <nav class="main-menu">
      <ul class="main-menu__wrapper">
        {{ range site.Menus.main }}
        {{ if .HasChildren }}
        <li class="menu-item-has-children">
          <a href="#"><span>{{ .Name }}</span></a>
          <div class="sub-menu">
            <div class="col-container">
              <div class="col1">
                <ul class="menu">
                  <li class="menu-title">Main</li>
                  {{ range first 5 .Children }}
                  <li class="menu-item">
                    <a href="{{ .URL | absURL }}" {{ with .Pre }} target="{{ . }}" {{ end }}>
                      {{ .Name }}
                      {{ if .Post }}<span class="menu-description">{{ .Post }}</span>{{ end }}
                    </a>
                  </li>
                  {{ end }}
                </ul>
              </div>
              <div class="col2">
                <ul class="menu">
                  <li class="menu-title">Additional Info</li>
                  {{ range after 5 .Children }}
                  <li class="menu-item">
                    <a href="{{ .URL | absURL }}" {{ with .Pre }} target="{{ . }}" {{ end }}>
                      {{ .Name }}
                      {{ if .Post }}<span class="menu-description">{{ .Post }}</span>{{ end }}
                    </a>
                  </li>
                  {{ end }}
                </ul>
              </div>
              <div class="col3">
                <ul class="menu">
                  <li class="menu-title">Featured Articles</li>
                </ul>
                <div class="featured-articles">
                  {{ if eq .Name "About" }}
                  <div class="article-card">
                    <img src="/images/featured/about.jpg" alt="About Us">
                    <h4>Who We Are</h4>
                    <p>Learn more about InnerSource Commons</p>
                  </div>
                  {{ else if eq .Name "Projects" }}
                  <div class="article-card">
                    <img src="/images/featured/projects.jpg" alt="Our Projects">
                    <h4>Latest Projects</h4>
                    <p>Discover our latest InnerSource initiatives</p>
                  </div>
                  {{ else if eq .Name "Blog & News" }}
                  {{ $pages := where site.Pages "Type" "in" "announcements" }}
                  {{ $pages = where $pages "Kind" "in" "page" }}
                  {{ range first 3 $pages }}
                  <div class="article-card">
                    <a href="{{ .Permalink }}" class="article-link">
                      {{ with .Params.image }}
                      <div class="article-image">
                        <img src="{{ . | absURL }}" alt="{{ $.Title }}">
                      </div>
                      {{ end }}
                      <div class="article-content">
                        <h4>{{ .Title }}</h4>
                      </div>
                    </a>
                  </div>
                  {{ end }}
                  {{ end }}
                </div>
              </div>
            </div>
          </div>
        </li>
        {{ else }}
        <li class="menu-item">
          <a href="{{ .URL | absURL }}" {{ with .Pre }} target="{{ . }}" {{ end }}><span>{{ .Name }}</span></a>
        </li>
        {{ end }}
        {{ end }}
      </ul>

      <div class="header-cta">
        <a href="{{ "slack" | absURL }}" class="btn btn-primary" target="_blank">
          <i class="ti-comments pr-2"></i>{{ T "join_slack" }}
        </a>
        {{ if in .CurrentSection.Permalink "/learn/learning-path"}}
        <select id="langpicker" class="selectpicker" data-style="btn-light" data-width="fit">
          <option>{{ .Site.Language.LanguageName }}</option>
          {{ range .Translations }}
          <option value="{{ .Permalink }}">{{ .Language.LanguageName }}</option>
          {{ end }}
        </select>
        {{ else }}
        <select id="langpicker" class="selectpicker" data-style="btn-light" data-width="fit">
          <option>{{ .Site.Language.LanguageName }}</option>
          {{ range where .Translations ".Language.Lang" "in" "en ja fr pt-br"}}
          <option value="{{ .Permalink }}">{{ .Language.LanguageName }}</option>
          {{ end }}
        </select>
        {{ end }}
      </div>
    </nav>

    <button class="hamburger" type="button" aria-label="Toggle Menu">
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
  </div>
</header>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const hamburger = document.querySelector('.hamburger');
  const menu = document.querySelector('.main-menu__wrapper');
  const subMenuParents = document.querySelectorAll('.menu-item-has-children > a');
  const isMobile = window.innerWidth <= 992;

  // ハンバーガーメニューの開閉
  hamburger.addEventListener('click', function() {
    this.classList.toggle('is-active');
    menu.classList.toggle('is-active');
  });

  // モバイル時のサブメニュー制御
  if (isMobile) {
    subMenuParents.forEach(item => {
      item.addEventListener('click', function(e) {
        e.preventDefault();
        const parent = this.parentElement;
        const subMenu = this.nextElementSibling;
        
        // 他のメニューを閉じる
        subMenuParents.forEach(otherItem => {
          if (otherItem !== this) {
            otherItem.parentElement.classList.remove('is-active');
            otherItem.nextElementSibling.classList.remove('is-active');
          }
        });

        // 現在のメニューをトグル
        parent.classList.toggle('is-active');
        subMenu.classList.toggle('is-active');
      });
    });
  }

  // ウィンドウリサイズ時の処理
  window.addEventListener('resize', function() {
    const isNowMobile = window.innerWidth <= 992;
    if (isNowMobile !== isMobile) {
      location.reload();
    }
  });
});
</script>

{{ "<!-- /navigation -->" | safeHTML }}

{{ range site.Data.news }}
{{ if .active }}
<section class="notice bg-{{ .type }}{{ if eq .type "primary" }} text-light{{ end }}">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-12">
        {{ if .url }}
          <i class="ti-calendar mr-2"></i>
          <a href="{{ .url }}" target="_blank">{{ .content }}</a>
        {{ else }}
          {{ .content | markdownify }}
        {{ end }}
      </div>
    </div>
  </div>
</section>
{{ end }}
{{ end }}

